% sitds - compare spherical-head model ITDs.
%
% See also: sitd

%234567890 234567890 234567890 234567890 234567890 234567890 234567890 234567890

% Copyright (C) 2001-2018 United States Government as represented by the
% Administrator of the National Aeronautics and Space Administration (NASA).
% All Rights Reserved.
% 
% This software is distributed under the NASA Open Source Agreement (NOSA),
% version 1.3.  The NOSA has been approved by the Open Source Initiative.
% See the file NOSA.txt at the top of the distribution directory tree for the
% complete NOSA document.
% 
% THE SUBJECT SOFTWARE IS PROVIDED "AS IS" WITHOUT ANY WARRANTY OF ANYKIND,
% EITHER EXPRESSED, IMPLIED, OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, ANY
% WARRANTY THAT THE SUBJECT SOFTWARE WILL CONFORM TO SPECIFICATIONS, ANY IMPLIED
% WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR FREEDOM
% FROM INFRINGEMENT, ANY WARRANTY THAT THE SUBJECT SOFTWARE WILL BE ERROR FREE,
% OR ANY WARRANTY THAT DOCUMENTATION, IF PROVIDED, WILL CONFORM TO THE SUBJECT
% SOFTWARE.

% modification history
% --------------------
%                ----  v6.6.0  ----
% 04.20.11  JDM  created
%
% JDM == Joel D. Miller

% ----  measurement/head radii comparison  ----

% from sitd.m
hr = 0.09;  % Fritz and JDM approx head radius
sos = 346;  % speed of sound, m/s (346 in slabdefs.h)
%sos = 340; % speed of sound, m/s (Minnaar paper)

%   90   0:  681.72  680.42  674.87  603.66  757.47  668.70  SOS 346 m/s
%   90   0:  693.75  692.42  686.78  614.31  770.83  680.50  SOS 340 m/s
%
% (refer to MAX output below)

itd1 = [];   % hr  0.09m  ACD HeadZap          0.9m
itd2 = [];   % hr  0.09m  ACD Snapshot, CIPIC  1.0m
itd3 = [];   % hr  0.09m  Listen               1.9m
itd4 = [];   % hr  0.08m                       1.0m
itd5 = [];   % hr  0.10m                       1.0m
ws   = [];   % hr  0.09m                       N/A
fprintf( '\nWoodworth&Schlosberg asin(D/2r) threshold:\n' );
fprintf( '  HeadZap        = %.1f degs\n', asin(0.09/0.9)*180/pi );
fprintf( '  Snapshot/CIPIC = %.1f degs\n', asin(0.09/1.0)*180/pi );
fprintf( '  Listen         = %.1f degs\n', asin(0.09/1.9)*180/pi );
fprintf( '\n' );
for el = 90:-15:-90
  for az = 180:-30:-170
  %for az = 10:-1:-10  % to view sin(phi)<=D/2r WS region
      % ITD in us, sitd() or sitdw()
      itd1 = [ itd1, sitd( az, el, 0.09, 0.9 ) ];
      itd2 = [ itd2, sitd( az, el, 0.09, 1.0 ) ];
      itd3 = [ itd3, sitd( az, el, 0.09, 1.9 ) ];
      itd4 = [ itd4, sitd( az, el, 0.08, 1.0 ) ];
      itd5 = [ itd5, sitd( az, el, 0.10, 1.0 ) ];

      % Woodworth&Schlosberg, sld >> hr, r >> Dh
      w = sitdw( az, el, hr, 1.0, 1 );
      ws = [ ws, w ];

      %fprintf( '%4d %3d:  %6.3f\n', az, el, sin(azr) );
      fprintf( '%4d %3d: %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f\n', az, el, ...
        itd1(end), itd2(end), itd3(end), itd4(end), itd5(end), w );
  end;
end;
plot([ itd1' itd2' itd3' itd4' itd5' ws' ]);
grid on;
legend( '0.09 0.9', '0.09 1.0', '0.09 1.9', '0.08 1.0', '0.10 1.0', ...
        '0.09' );

% for comparing
if 0,
itd1c=itd1;
itd2c=itd2;
itd3c=itd3;
itd4c=itd4;
itd5c=itd5;
end;

if 0,
[ mx mi ] = max(abs(itd1c-itd1)); [ mx mi ]
[ mx mi ] = max(abs(itd2c-itd2)); [ mx mi ]
[ mx mi ] = max(abs(itd3c-itd3)); [ mx mi ]
[ mx mi ] = max(abs(itd4c-itd4)); [ mx mi ]
[ mx mi ] = max(abs(itd5c-itd5)); [ mx mi ]
end;

% [ mx mi ]
%
% az = 10:-1:-10
%
%     0.0432   11.0000  WS to WS with only sin(phi)>D/2r expression
%     0.0315   11.0000
%     0.0894  147.0000
%     0.0326  147.0000
%     0.0480   11.0000
%
%     0.0179  147.0000  WS to Miller
%     0.0262  147.0000
%     0.0894  147.0000
%     0.0326  147.0000
%     0.0199  147.0000
%
% az = 180:-30:-170
%
%     0.0000   14.0000  WS to Miller
%     0.0000   50.0000
%     0.0000   62.0000
%     0.0000   14.0000
%     0.0000   39.0000

% SOS 346 m/s

%  180  15:    0.00    0.00    0.00    0.00    0.00    0.00  us
%  150  15:  259.29  259.08  258.06  230.09  288.10  256.73
%  120  15:  484.10  483.25  479.57  428.80  537.89  475.34
%   90  15:  603.80  602.60  597.47  534.58  670.88  591.74
%   60  15:  484.10  483.25  479.57  428.80  537.89  475.34
%   30  15:  259.29  259.08  258.06  230.09  288.10  256.73
%    0  15:    0.00    0.00    0.00    0.00    0.00    0.00
%  -30  15: -259.29 -259.08 -258.06 -230.09 -288.10 -256.73
%  -60  15: -484.10 -483.25 -479.57 -428.80 -537.89 -475.34
%  -90  15: -603.80 -602.60 -597.47 -534.58 -670.88 -591.74
% -120  15: -484.10 -483.25 -479.57 -428.80 -537.89 -475.34
% -150  15: -259.29 -259.08 -258.06 -230.09 -288.10 -256.73
%  180   0:    0.00    0.00    0.00    0.00    0.00    0.00
%  150   0:  269.02  268.79  267.69  238.71  298.92  266.25
%  120   0:  507.12  506.20  502.22  449.13  563.47  497.66
%   90   0:  681.72  680.42  674.87  603.66  757.47  668.70  MAX
%   60   0:  507.12  506.20  502.22  449.13  563.47  497.66
%   30   0:  269.02  268.79  267.69  238.71  298.92  266.25
%    0   0:    0.00    0.00    0.00    0.00    0.00    0.00
%  -30   0: -269.02 -268.79 -267.69 -238.71 -298.92 -266.25
%  -60   0: -507.12 -506.20 -502.22 -449.13 -563.47 -497.66
%  -90   0: -681.72 -680.42 -674.87 -603.66 -757.47 -668.70
% -120   0: -507.12 -506.20 -502.22 -449.13 -563.47 -497.66
% -150   0: -269.02 -268.79 -267.69 -238.71 -298.92 -266.25
%  180 -15:    0.00    0.00    0.00    0.00    0.00    0.00
%  150 -15:  259.29  259.08  258.06  230.09  288.10  256.73
%  120 -15:  484.10  483.25  479.57  428.80  537.89  475.34
%   90 -15:  603.80  602.60  597.47  534.58  670.88  591.74
%   60 -15:  484.10  483.25  479.57  428.80  537.89  475.34
%   30 -15:  259.29  259.08  258.06  230.09  288.10  256.73
%    0 -15:    0.00    0.00    0.00    0.00    0.00    0.00
%  -30 -15: -259.29 -259.08 -258.06 -230.09 -288.10 -256.73
%  -60 -15: -484.10 -483.25 -479.57 -428.80 -537.89 -475.34
%  -90 -15: -603.80 -602.60 -597.47 -534.58 -670.88 -591.74
% -120 -15: -484.10 -483.25 -479.57 -428.80 -537.89 -475.34
% -150 -15: -259.29 -259.08 -258.06 -230.09 -288.10 -256.73

% SOS 340 m/s

%  180  15:    0.00    0.00    0.00    0.00    0.00    0.00
%  150  15:  263.87  263.65  262.62  234.16  293.19  261.26
%  120  15:  492.64  491.78  488.04  436.37  547.38  483.73
%   90  15:  614.45  613.23  608.02  544.01  682.72  602.19
%   60  15:  492.64  491.78  488.04  436.37  547.38  483.73
%   30  15:  263.87  263.65  262.62  234.16  293.19  261.26
%    0  15:    0.00    0.00    0.00    0.00    0.00    0.00
%  -30  15: -263.87 -263.65 -262.62 -234.16 -293.19 -261.26
%  -60  15: -492.64 -491.78 -488.04 -436.37 -547.38 -483.73
%  -90  15: -614.45 -613.23 -608.02 -544.01 -682.72 -602.19
% -120  15: -492.64 -491.78 -488.04 -436.37 -547.38 -483.73
% -150  15: -263.87 -263.65 -262.62 -234.16 -293.19 -261.26
%  180   0:    0.00    0.00    0.00    0.00    0.00    0.00
%  150   0:  273.77  273.53  272.41  242.92  304.19  270.95
%  120   0:  516.07  515.13  511.08  457.06  573.41  506.44
%   90   0:  693.75  692.42  686.78  614.31  770.83  680.50  MAX
%   60   0:  516.07  515.13  511.08  457.06  573.41  506.44
%   30   0:  273.77  273.53  272.41  242.92  304.19  270.95
%    0   0:    0.00    0.00    0.00    0.00    0.00    0.00
%  -30   0: -273.77 -273.53 -272.41 -242.92 -304.19 -270.95
%  -60   0: -516.07 -515.13 -511.08 -457.06 -573.41 -506.44
%  -90   0: -693.75 -692.42 -686.78 -614.31 -770.83 -680.50
% -120   0: -516.07 -515.13 -511.08 -457.06 -573.41 -506.44
% -150   0: -273.77 -273.53 -272.41 -242.92 -304.19 -270.95
%  180 -15:    0.00    0.00    0.00    0.00    0.00    0.00
%  150 -15:  263.87  263.65  262.62  234.16  293.19  261.26
%  120 -15:  492.64  491.78  488.04  436.37  547.38  483.73
%   90 -15:  614.45  613.23  608.02  544.01  682.72  602.19
%   60 -15:  492.64  491.78  488.04  436.37  547.38  483.73
%   30 -15:  263.87  263.65  262.62  234.16  293.19  261.26
%    0 -15:    0.00    0.00    0.00    0.00    0.00    0.00
%  -30 -15: -263.87 -263.65 -262.62 -234.16 -293.19 -261.26
%  -60 -15: -492.64 -491.78 -488.04 -436.37 -547.38 -483.73
%  -90 -15: -614.45 -613.23 -608.02 -544.01 -682.72 -602.19
% -120 -15: -492.64 -491.78 -488.04 -436.37 -547.38 -483.73
% -150 -15: -263.87 -263.65 -262.62 -234.16 -293.19 -261.26
